<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Quiz Game</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f7fb; margin: 0; padding: 0; text-align: center; }
  .quiz-container { max-width: 600px; margin: auto; padding: 20px; }
  h1 { color: #333; }
  .question { font-size: 1.2em; margin: 15px 0; }
  .question img { max-width: 100%; height: auto; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; }
  .btn { display: block; width: 100%; background: #fff; border: 2px solid #007bff; color: #007bff; padding: 12px; margin: 8px 0; border-radius: 8px; font-size: 1em; cursor: pointer; }
  .btn.correct { background: #28a745; color: #fff; }
  .btn.wrong { background: #dc3545; color: #fff; }
  #next-btn { display: none; margin-top: 15px; padding: 12px 20px; border-radius: 8px; background: #007bff; color: #fff; border: none; }
  .score { font-size: 1.5em; margin-top: 20px; color: #333; }
  .drag-container { margin: 20px auto; max-width: 500px; }
  .drop-zone { border: 2px dashed #aaa; border-radius: 8px; padding: 20px; margin: 10px 0; min-height: 60px; }
  .draggable { display: inline-block; margin: 10px; padding: 10px 15px; background: #007bff; color: white; border-radius: 6px; cursor: grab; }
  .correct-drop { background: #28a745 !important; }
  .wrong-drop { background: #dc3545 !important; }
</style>
</head>
<body>
<div class="quiz-container">
  <h1>Study Quiz Game</h1>
  <div id="question-container">
    <div class="question" id="question">Loading...</div>
    <div id="answer-buttons"></div>
  </div>
  <button id="next-btn">Next Question</button>
  <div class="score" id="score"></div>
</div>

<!-- Drag & Drop Section -->
<div class="quiz-container" id="drag-section" style="display:none;">
  <h2>Drag & Drop Labeling</h2>
  <p>Drag the correct label onto the highlighted structure.</p>
  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2b/Diagram_of_the_human_heart_%28cropped%29.svg" alt="Heart Diagram">
  
  <div class="drop-zone" id="drop-spleen">Drop Here (Mitral Valve)</div>
  <div>
    <span class="draggable" draggable="true" id="label1">Tricuspid Valve</span>
    <span class="draggable" draggable="true" id="label2">Mitral Valve</span>
    <span class="draggable" draggable="true" id="label3">Aortic Valve</span>
  </div>
  <p id="drag-feedback"></p>
</div>

<script>
const questions = [
  { question: "Which gland releases insulin?", answers: ["Pancreas", "Thyroid", "Adrenal Cortex", "Ovary"], correct: 0 },
  { question: "What hormone lowers blood calcium?", answers: ["PTH", "Calcitonin", "Aldosterone", "Cortisol"], correct: 1 },
  { question: "Identify this structure:", image: "https://upload.wikimedia.org/wikipedia/commons/5/5c/Respiratory_system_complete_en.svg", answers: ["Trachea", "Alveoli", "Bronchi", "Epiglottis"], correct: 0 },
  { question: "Which blood cell type fights parasites?", image: "https://upload.wikimedia.org/wikipedia/commons/9/9c/Eosinophil_smear_200x.png", answers: ["Neutrophil", "Eosinophil", "Basophil", "Lymphocyte"], correct: 1 }
];

let shuffledQuestions = [];
let currentQuestionIndex = 0;
let score = 0;

const questionElement = document.getElementById("question");
const answerButtons = document.getElementById("answer-buttons");
const nextButton = document.getElementById("next-btn");
const scoreElement = document.getElementById("score");
const dragSection = document.getElementById("drag-section");

function startGame() {
  shuffledQuestions = questions.sort(() => Math.random() - 0.5);
  currentQuestionIndex = 0;
  score = 0;
  scoreElement.innerText = "";
  nextButton.innerText = "Next Question";
  showQuestion();
}

function showQuestion() {
  resetState();
  let currentQuestion = shuffledQuestions[currentQuestionIndex];
  questionElement.innerHTML = currentQuestion.question;
  if (currentQuestion.image) {
    const img = document.createElement("img");
    img.src = currentQuestion.image;
    questionElement.appendChild(img);
  }
  currentQuestion.answers.forEach((answer, index) => {
    const button = document.createElement("button");
    button.innerText = answer;
    button.classList.add("btn");
    if (index === currentQuestion.correct) button.dataset.correct = true;
    button.addEventListener("click", selectAnswer);
    answerButtons.appendChild(button);
  });
}

function resetState() {
  nextButton.style.display = "none";
  while (answerButtons.firstChild) {
    answerButtons.removeChild(answerButtons.firstChild);
  }
}

function selectAnswer(e) {
  const selectedBtn = e.target;
  const isCorrect = selectedBtn.dataset.correct === "true";
  if (isCorrect) { selectedBtn.classList.add("correct"); score++; }
  else { selectedBtn.classList.add("wrong"); }
  Array.from(answerButtons.children).forEach(b => {
    if (b.dataset.correct === "true") b.classList.add("correct");
    b.disabled = true;
  });
  nextButton.style.display = "block";
}

nextButton.addEventListener("click", () => {
  currentQuestionIndex++;
  if (currentQuestionIndex < shuffledQuestions.length) {
    showQuestion();
  } else {
    showScore();
  }
});

function showScore() {
  resetState();
  questionElement.innerText = "Quiz Finished!";
  scoreElement.innerText = `Your score: ${score} / ${shuffledQuestions.length}`;
  nextButton.innerText = "Try Drag & Drop";
  nextButton.style.display = "block";
  nextButton.onclick = () => {
    document.querySelector(".quiz-container").style.display = "none";
    dragSection.style.display = "block";
  };
}

startGame();

// Drag & Drop
const draggables = document.querySelectorAll(".draggable");
const dropZone = document.getElementById("drop-spleen");
const feedback = document.getElementById("drag-feedback");

draggables.forEach(d => {
  d.addEventListener("dragstart", dragStart);
});

dropZone.addEventListener("dragover", e => {
  e.preventDefault();
});
dropZone.addEventListener("drop", drop);

function dragStart(e) {
  e.dataTransfer.setData("text", e.target.id);
}
function drop(e) {
  e.preventDefault();
  const id = e.dataTransfer.getData("text");
  const draggedElement = document.getElementById(id);
  if (id === "label2") {
    dropZone.classList.add("correct-drop");
    feedback.innerText = "✅ Correct! This is the Mitral Valve.";
  } else {
    dropZone.classList.add("wrong-drop");
    feedback.innerText = "❌ Incorrect. Try again!";
  }
}
</script>
</body>
</html>
